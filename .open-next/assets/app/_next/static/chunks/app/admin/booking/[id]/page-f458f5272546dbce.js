(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[328],{63:(e,t,a)=>{"use strict";var s=a(7260);a.o(s,"useParams")&&a.d(t,{useParams:function(){return s.useParams}}),a.o(s,"usePathname")&&a.d(t,{usePathname:function(){return s.usePathname}}),a.o(s,"useRouter")&&a.d(t,{useRouter:function(){return s.useRouter}}),a.o(s,"useSelectedLayoutSegments")&&a.d(t,{useSelectedLayoutSegments:function(){return s.useSelectedLayoutSegments}})},3230:(e,t,a)=>{Promise.resolve().then(a.bind(a,3710))},3710:(e,t,a)=>{"use strict";a.d(t,{default:()=>u});var s=a(5155),l=a(2115),n=a(63);let o=function(e){let{providers:t,value:a,onChange:l}=e;return(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"font-medium block mb-1",children:"Provider:"}),(0,s.jsxs)("select",{className:"border rounded p-2 w-full",value:a,onChange:e=>l(e.target.value),children:[0===t.length&&(0,s.jsx)("option",{children:"No active providers"}),t.map(e=>(0,s.jsxs)("option",{value:e.id,children:[e.firstName," ",e.lastName]},e.id))]})]})},i=function(e){let{label:t,type:a="text",value:l,onChange:n,options:o}=e;return(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"font-medium block mb-1",children:t}),"textarea"===a?(0,s.jsx)("textarea",{className:"border rounded p-2 w-full",rows:3,value:l,onChange:e=>n(e.target.value)}):"select"===a&&o?(0,s.jsx)("select",{className:"border rounded p-2 w-full",value:l,onChange:e=>n(e.target.value),children:o.map(e=>(0,s.jsx)("option",{value:e,children:e},e))}):(0,s.jsx)("input",{type:a,className:"border rounded p-2 w-full",value:l,onChange:e=>n(e.target.value)})]})},r=function(e){let{booking:t,onSave:a}=e,[n,r]=(0,l.useState)(t),[u,c]=(0,l.useState)([]);(0,l.useEffect)(()=>{r(t)},[t]);let d=async()=>{try{let e=await fetch("/app/api/team/getActiveProvider"),t=await e.json();c(t.team)}catch(e){console.error(e)}};(0,l.useEffect)(()=>{d()},[]);let h=(e,t)=>{r(a=>({...a,[e]:t}))};return(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)(o,{providers:u,value:null==n?void 0:n.providerId,onChange:e=>{let t=u.find(t=>t.id===e);t&&h("provider",t)}}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsx)(i,{label:"Date",type:"date",value:new Date(n.date).toISOString().split("T")[0],onChange:e=>h("date",e)}),(0,s.jsx)(i,{label:"Time",type:"time",value:null==n?void 0:n.time,onChange:e=>h("time",e)})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsx)(i,{label:"Price (R)",type:"number",value:null==n?void 0:n.price,onChange:e=>h("price",parseFloat(e))}),(0,s.jsx)(i,{label:"Duration (minutes)",type:"number",value:null==n?void 0:n.sessionDuration,onChange:e=>h("sessionDuration",parseInt(e))})]}),(0,s.jsx)(i,{label:"Status",type:"select",options:["PENDING","CONFIRMED","COMPLETED","CANCELLED"],value:null==n?void 0:n.status,onChange:e=>h("status",e)}),(0,s.jsx)(i,{label:"Special Requests",type:"textarea",value:(null==n?void 0:n.specialRequests)||"",onChange:e=>h("specialRequests",e)}),(0,s.jsx)("button",{onClick:()=>a(n),className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 w-full",children:"Save Changes"})]})},u=function(){var e,t,a,o,i;let{id:u}=(0,n.useParams)();(0,n.useRouter)();let[c,d]=(0,l.useState)(null),[h,p]=(0,l.useState)(!0),[m,v]=(0,l.useState)(""),g=async()=>{try{let e=await fetch("/app/api/booking/".concat(u));if(!e.ok)throw Error("Failed to fetch booking");let t=await e.json();d(t)}catch(e){v("Error fetching booking details")}finally{p(!1)}},x=async e=>{if(c)try{if(!(await fetch("/app/api/booking/".concat(u),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).ok)throw Error("Failed to update booking");await g(),alert("✅ Booking updated successfully!")}catch(e){console.error(e),alert("❌ Failed to update booking.")}};return((0,l.useEffect)(()=>{u&&g()},[u]),h)?(0,s.jsx)("div",{className:"p-6",children:"Loading booking..."}):m?(0,s.jsx)("div",{className:"p-6 text-red-600",children:m}):c?(0,s.jsxs)("div",{className:"p-8 max-w-2xl mx-auto bg-white rounded-lg shadow",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold mb-6",children:null==(e=c.services)?void 0:e.name}),(0,s.jsxs)("h2",{children:["client: ",null==(t=c.client)?void 0:t.firstName," ",null==(a=c.client)?void 0:a.lastName]}),(0,s.jsxs)("h2",{children:["contact: ",null==(o=c.client)?void 0:o.email," "]}),(0,s.jsxs)("h2",{children:[" ",null==(i=c.client)?void 0:i.phone," "]}),(0,s.jsx)(r,{booking:c,onSave:x})]}):(0,s.jsx)("div",{className:"p-6",children:"Booking not found"})}}},e=>{e.O(0,[441,255,358],()=>e(e.s=3230)),_N_E=e.O()}]);