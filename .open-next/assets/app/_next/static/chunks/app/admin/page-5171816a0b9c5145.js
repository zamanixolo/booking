(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[698],{63:(e,s,t)=>{"use strict";var r=t(7260);t.o(r,"useParams")&&t.d(s,{useParams:function(){return r.useParams}}),t.o(r,"usePathname")&&t.d(s,{usePathname:function(){return r.usePathname}}),t.o(r,"useRouter")&&t.d(s,{useRouter:function(){return r.useRouter}}),t.o(r,"useSelectedLayoutSegments")&&t.d(s,{useSelectedLayoutSegments:function(){return r.useSelectedLayoutSegments}})},3954:(e,s,t)=>{Promise.resolve().then(t.bind(t,8423))},5181:(e,s,t)=>{"use strict";function r(e){if(!e)return[];try{let s=JSON.parse(e);if(Array.isArray(s))return s;if("string"==typeof s)return[s]}catch(e){}return e.includes(",")?e.split(",").map(e=>e.trim()).filter(Boolean):[e.trim()]}t.d(s,{A:()=>r})},8423:(e,s,t)=>{"use strict";t.d(s,{default:()=>c});var r=t(5155),a=t(2115),i=t(5181);let n=function(){let[e,s]=(0,a.useState)([]),[t,n]=(0,a.useState)([]),[l,o]=(0,a.useState)([]),[c,d]=(0,a.useState)(""),[m,u]=(0,a.useState)({members:[],price:650,session:60}),[x,g]=(0,a.useState)(null),[h,b]=(0,a.useState)(!1);(0,a.useEffect)(()=>{p(),f(),N()},[]);let p=async()=>{try{let e=await fetch("/app/api/services");e.ok&&s(await e.json())}catch(e){console.error("Error fetching services:",e)}},f=async()=>{try{let e=await fetch("/app/api/team/getActiveProvider");if(e.ok){let s=await e.json();n(s.team||[])}}catch(e){console.error("Error fetching providers:",e)}},N=async()=>{try{let e=await fetch("/app/api/booking-settings");if(e.ok){let s=await e.json();o(s)}}catch(e){console.error("Error fetching booking settings:",e)}};(0,a.useEffect)(()=>{if(!c){u({members:[],price:650,session:60}),g(null);return}let e=l.find(e=>e.serviceId===c);if(e){g(e.id);let s=(0,i.A)(e.providerIds);u({members:t.filter(e=>s.includes(e.id)).map(e=>({id:e.id,memberName:"".concat(e.firstName," ").concat(e.lastName)})),price:e.defaultPrice,session:e.defaultSessionDuration})}else g(null),u({members:[],price:650,session:60})},[c,l,t]);let v=async()=>{if(!c)return alert("Please select a service");b(!0);try{let e={providerIds:m.members.map(e=>e.id),serviceId:c,defaultSessionDuration:m.session,defaultPrice:m.price},s=x?"/app/api/booking-settings/".concat(x):"/app/api/booking-settings",t=x?"PUT":"POST";(await fetch(s,{method:t,headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).ok?(alert("Booking setting saved"),N()):alert("Failed to save booking setting")}catch(e){console.error("Error saving booking setting:",e),alert("Error saving booking setting")}finally{b(!1)}},j=async()=>{if(x&&confirm("Are you sure you want to delete this booking setting?")){b(!0);try{(await fetch("/app/api/booking-settings/".concat(x),{method:"DELETE"})).ok?(alert("Booking setting deleted"),u({members:[],price:650,session:60}),d(""),g(null),N()):alert("Failed to delete booking setting")}catch(e){console.error("Error deleting booking setting:",e),alert("Error deleting booking setting")}finally{b(!1)}}};return(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"Booking Settings"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{className:"bg-white p-4 shadow rounded md:col-span-2",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"Select Service"}),(0,r.jsxs)("select",{value:c,onChange:e=>{d(e.target.value)},className:"border px-3 py-2 rounded w-full",children:[(0,r.jsx)("option",{value:"",children:"Select a service"}),e.map(e=>(0,r.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,r.jsxs)("div",{className:"bg-white p-4 shadow rounded",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"Session Duration"}),(0,r.jsx)("input",{type:"number",value:m.session,onChange:e=>u(s=>({...s,session:parseInt(e.target.value)||60})),className:"border px-3 py-2 w-full rounded",min:15,step:15})]}),(0,r.jsxs)("div",{className:"bg-white p-4 shadow rounded",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"Price"}),(0,r.jsx)("input",{type:"number",value:m.price,onChange:e=>u(s=>({...s,price:parseFloat(e.target.value)||650})),className:"border px-3 py-2 w-full rounded",min:0,step:.01})]}),(0,r.jsxs)("div",{className:"bg-white p-4 shadow rounded md:col-span-2",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"Team Members"}),(0,r.jsx)("div",{className:"flex gap-2 flex-wrap mb-4",children:t.map(e=>(0,r.jsxs)("button",{type:"button",className:"border px-3 py-2 rounded transition ".concat(m.members.some(s=>s.id===e.id)?"bg-blue-100 border-blue-300":"hover:bg-gray-50"),onClick:()=>{var s,t;return s="".concat(e.firstName," ").concat(e.lastName),t=e.id,void(!m.members.some(e=>e.id===t)&&u(e=>({...e,members:[...e.members,{id:t,memberName:s}]})))},disabled:m.members.some(s=>s.id===e.id),children:[e.firstName," ",e.lastName]},e.id))}),m.members.length>0&&(0,r.jsxs)("div",{className:"mt-2",children:[(0,r.jsx)("h3",{className:"text-sm font-medium mb-2",children:"Selected Members"}),(0,r.jsx)("div",{className:"flex gap-2 flex-wrap",children:m.members.map(e=>(0,r.jsxs)("button",{type:"button",className:"border px-3 py-2 rounded bg-red-100 hover:bg-red-200 transition",onClick:()=>{var s;return s=e.id,void u(e=>({...e,members:e.members.filter(e=>e.id!==s)}))},children:[e.memberName," \xd7"]},e.id))})]})]}),(0,r.jsxs)("div",{className:"md:col-span-2 flex justify-between items-center",children:[x&&(0,r.jsx)("button",{onClick:j,disabled:h,className:"bg-red-600 text-white px-6 py-2 rounded hover:bg-red-700 transition disabled:bg-red-400",children:"Delete Setting"}),(0,r.jsx)("button",{onClick:v,disabled:h,className:"bg-blue-600 text-white px-6 py-2 rounded hover:bg-blue-700 transition disabled:bg-blue-400",children:h?"Saving...":x?"Update Setting":"Create Setting"})]})]})]})};var l=t(63);let o=function(){let e=(0,l.useRouter)(),[s,t]=(0,a.useState)([]),[i,n]=(0,a.useState)(!0),[o,c]=(0,a.useState)(""),d=async()=>{try{n(!0);let e=await fetch("/app/api/booking");if(!e.ok)throw Error("Failed to fetch bookings");let s=await e.json();t(s)}catch(e){c("Error fetching bookings"),console.error(e)}finally{n(!1)}};return((0,a.useEffect)(()=>{d()},[]),i)?(0,r.jsx)("div",{className:"flex justify-center items-center min-h-64",children:(0,r.jsx)("div",{className:"text-lg",children:"Loading bookings..."})}):o?(0,r.jsx)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded",children:o}):(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"All Bookings"}),0===s.length?(0,r.jsx)("div",{className:"text-center py-8",children:(0,r.jsx)("p",{className:"text-gray-500 text-lg",children:"No bookings found."})}):(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:s.map(s=>{var t,a,i,n,l,o;return(0,r.jsx)("div",{className:"bg-white border shadow-sm hover:shadow-md transition-shadow",children:(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,r.jsx)("div",{children:(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:null==(t=s.services)?void 0:t.name})}),(0,r.jsx)("span",{className:"px-2 py-1 text-xs font-medium ".concat((e=>{switch(e){case"CONFIRMED":return"bg-green-100 text-green-800";case"PENDING":return"bg-yellow-100 text-yellow-800";case"COMPLETED":return"bg-blue-100 text-blue-800";case"CANCELLED":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}})(null==s?void 0:s.status)),children:s.status})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-700",children:"Provider"}),(0,r.jsxs)("p",{className:"text-sm text-gray-900",children:[null==(a=s.provider)?void 0:a.firstName," ",null==(i=s.provider)?void 0:i.lastName]})]}),s.client&&(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-700",children:"Client"}),(0,r.jsxs)("p",{className:"text-sm text-gray-900",children:[s.client.firstName," ",null==(n=s.client)?void 0:n.lastName]}),(0,r.jsx)("p",{className:"text-xs text-gray-500",children:null==(l=s.client)?void 0:l.email})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-700",children:"Date & Time"}),(0,r.jsx)("p",{className:"text-sm text-gray-900",children:new Date(s.date).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}),(0,r.jsx)("p",{className:"text-sm text-gray-900",children:s.time})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-700",children:"Session Details"}),(0,r.jsxs)("p",{className:"text-sm text-gray-900",children:[s.sessionDuration," minutes"]}),(0,r.jsxs)("p",{className:"text-sm text-gray-900",children:["R",null==s||null==(o=s.price)?void 0:o.toFixed(2)]})]}),s.specialRequests&&(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-700",children:"Special Requests"}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:null==s?void 0:s.specialRequests})]}),(0,r.jsxs)("div",{className:"flex justify-between items-center pt-4 border-t",children:[(0,r.jsxs)("p",{className:"text-xs text-gray-500",children:["Created: ",new Date(s.createdAt).toLocaleDateString()]}),(0,r.jsx)("button",{onClick:()=>{e.push("/admin/booking/".concat(s.id))},className:"text-sm text-blue-600 hover:text-blue-800",children:"View Details"})]})]})},s.id)})})]})},c=function(){let[e,s]=(0,a.useState)(0),[t,i]=(0,a.useState)([]);return(0,r.jsxs)("div",{children:[(0,r.jsxs)("section",{className:"flex justify-center gap-[0.5em] p-[2em]",children:[(0,r.jsx)("button",{onClick:()=>{s(0)},className:"border ".concat(0==e&&"bg-gray-400"),children:"View Booking"}),(0,r.jsx)("button",{onClick:()=>{s(1)},className:"border ".concat(1==e&&"bg-gray-400"),children:"Booking settings"})]}),(0,r.jsxs)("section",{children:[0==e&&(0,r.jsx)(o,{}),1==e&&(0,r.jsx)(n,{})]})]})}}},e=>{e.O(0,[441,255,358],()=>e(e.s=3954)),_N_E=e.O()}]);