(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[698],{63:(e,s,t)=>{"use strict";var a=t(7260);t.o(a,"useParams")&&t.d(s,{useParams:function(){return a.useParams}}),t.o(a,"usePathname")&&t.d(s,{usePathname:function(){return a.usePathname}}),t.o(a,"useRouter")&&t.d(s,{useRouter:function(){return a.useRouter}}),t.o(a,"useSelectedLayoutSegments")&&t.d(s,{useSelectedLayoutSegments:function(){return a.useSelectedLayoutSegments}})},3677:(e,s,t)=>{Promise.resolve().then(t.bind(t,8423))},8423:(e,s,t)=>{"use strict";t.d(s,{default:()=>c});var a=t(5155),r=t(2115);let i=function(){let[e,s]=(0,r.useState)([]),[t,i]=(0,r.useState)([]),[n,l]=(0,r.useState)([]),[c,o]=(0,r.useState)(""),[d,m]=(0,r.useState)({members:[],price:650,session:60}),[x,u]=(0,r.useState)(null),[h,g]=(0,r.useState)(!1);(0,r.useEffect)(()=>{b(),p(),N()},[]);let b=async()=>{try{let e=await fetch("/api/services");e.ok&&s(await e.json())}catch(e){console.error("Error fetching services:",e)}},p=async()=>{try{let e=await fetch("/api/team/getActiveProvider");e.ok&&i(await e.json())}catch(e){console.error("Error fetching providers:",e)}},N=async()=>{try{let e=await fetch("/api/booking-settings");if(e.ok){let s=await e.json();l(s)}}catch(e){console.error("Error fetching booking settings:",e)}};(0,r.useEffect)(()=>{if(!c)return;let e=n.find(e=>e.service.id===c);e?(u(e.id),m({members:e.providers.map(e=>({id:e.id,memberName:"".concat(e.firstName," ").concat(e.lastName)})),price:e.defaultPrice,session:e.defaultSessionDuration})):(u(null),m({members:[],price:650,session:60}))},[c,n]);let f=async()=>{if(!c)return alert("Please select a service");g(!0);try{let e={providerIds:d.members.map(e=>e.id),serviceId:c,defaultSessionDuration:d.session,defaultPrice:d.price};(await fetch(x?"/api/booking-settings/".concat(x):"/api/booking-settings",{method:x?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).ok?(alert("Booking setting saved"),N()):alert("Failed to save booking setting")}catch(e){console.error("Error saving booking setting:",e),alert("Error saving booking setting")}finally{g(!1)}};return(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"Booking Settings"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{className:"bg-white p-4 shadow rounded md:col-span-2",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"Select Service"}),(0,a.jsxs)("select",{value:c,onChange:e=>{o(e.target.value)},className:"border px-3 py-2 rounded w-full",children:[(0,a.jsx)("option",{value:"",children:"Select a service"}),e.map(e=>(0,a.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,a.jsxs)("div",{className:"bg-white p-4 shadow rounded",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"Session Duration"}),(0,a.jsx)("input",{type:"number",value:d.session,onChange:e=>m(s=>({...s,session:parseInt(e.target.value)||60})),className:"border px-3 py-2 w-full rounded",min:"15",step:"15"})]}),(0,a.jsxs)("div",{className:"bg-white p-4 shadow rounded",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"Price"}),(0,a.jsx)("input",{type:"number",value:d.price,onChange:e=>m(s=>({...s,price:parseFloat(e.target.value)||650})),className:"border px-3 py-2 w-full rounded",min:"0",step:"0.01"})]}),(0,a.jsxs)("div",{className:"bg-white p-4 shadow rounded md:col-span-2",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"Team Members"}),(0,a.jsx)("div",{className:"flex gap-2 flex-wrap mb-4",children:t.map(e=>(0,a.jsxs)("button",{type:"button",className:"border px-3 py-2 rounded transition ".concat(d.members.some(s=>s.id===e.id)?"bg-blue-100 border-blue-300":"hover:bg-gray-50"),onClick:()=>{var s,t;return s="".concat(e.firstName," ").concat(e.lastName),t=e.id,void(!d.members.some(e=>e.id===t)&&m(e=>({...e,members:[...e.members,{id:t,memberName:s}]})))},disabled:d.members.some(s=>s.id===e.id),children:[e.firstName," ",e.lastName]},e.id))}),d.members.length>0&&(0,a.jsxs)("div",{className:"mt-2",children:[(0,a.jsx)("h3",{className:"text-sm font-medium mb-2",children:"Selected Members"}),(0,a.jsx)("div",{className:"flex gap-2 flex-wrap",children:d.members.map(e=>(0,a.jsxs)("button",{type:"button",className:"border px-3 py-2 rounded bg-red-100 hover:bg-red-200 transition",onClick:()=>{var s;return s=e.id,void m(e=>({...e,members:e.members.filter(e=>e.id!==s)}))},children:[e.memberName," \xd7"]},e.id))})]})]}),(0,a.jsx)("div",{className:"md:col-span-2 flex justify-end",children:(0,a.jsx)("button",{onClick:f,disabled:h,className:"bg-blue-600 text-white px-6 py-2 rounded hover:bg-blue-700 transition disabled:bg-blue-400",children:h?"Saving...":x?"Update Setting":"Create Setting"})})]})]})};var n=t(63);let l=function(){let e=(0,n.useRouter)(),[s,t]=(0,r.useState)([]),[i,l]=(0,r.useState)(!0),[c,o]=(0,r.useState)(""),d=async()=>{try{l(!0);let e=await fetch("/api/booking");if(!e.ok)throw Error("Failed to fetch bookings");let s=await e.json();t(s)}catch(e){o("Error fetching bookings"),console.error(e)}finally{l(!1)}};return((0,r.useEffect)(()=>{d()},[]),i)?(0,a.jsx)("div",{className:"flex justify-center items-center min-h-64",children:(0,a.jsx)("div",{className:"text-lg",children:"Loading bookings..."})}):c?(0,a.jsx)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded",children:c}):(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"All Bookings"}),0===s.length?(0,a.jsx)("div",{className:"text-center py-8",children:(0,a.jsx)("p",{className:"text-gray-500 text-lg",children:"No bookings found."})}):(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:s.map(s=>(0,a.jsx)("div",{className:"bg-white border shadow-sm hover:shadow-md transition-shadow",children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,a.jsx)("div",{children:(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:s.services.name})}),(0,a.jsx)("span",{className:"px-2 py-1 text-xs font-medium ".concat((e=>{switch(e){case"CONFIRMED":return"bg-green-100 text-green-800";case"PENDING":return"bg-yellow-100 text-yellow-800";case"COMPLETED":return"bg-blue-100 text-blue-800";case"CANCELLED":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}})(s.status)),children:s.status})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-700",children:"Provider"}),(0,a.jsxs)("p",{className:"text-sm text-gray-900",children:[s.provider.firstName," ",s.provider.lastName]})]}),s.client&&(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-700",children:"Client"}),(0,a.jsxs)("p",{className:"text-sm text-gray-900",children:[s.client.firstName," ",s.client.lastName]}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:s.client.email})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-700",children:"Date & Time"}),(0,a.jsx)("p",{className:"text-sm text-gray-900",children:new Date(s.date).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}),(0,a.jsx)("p",{className:"text-sm text-gray-900",children:s.time})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-700",children:"Session Details"}),(0,a.jsxs)("p",{className:"text-sm text-gray-900",children:[s.sessionDuration," minutes"]}),(0,a.jsxs)("p",{className:"text-sm text-gray-900",children:["R",s.price.toFixed(2)]})]}),s.specialRequests&&(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-700",children:"Special Requests"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:s.specialRequests})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center pt-4 border-t",children:[(0,a.jsxs)("p",{className:"text-xs text-gray-500",children:["Created: ",new Date(s.createdAt).toLocaleDateString()]}),(0,a.jsx)("button",{onClick:()=>{e.push("/admin/booking/".concat(s.id))},className:"text-sm text-blue-600 hover:text-blue-800",children:"View Details"})]})]})},s.id))})]})},c=function(){let[e,s]=(0,r.useState)(0),[t,n]=(0,r.useState)([]);return(0,a.jsxs)("div",{children:[(0,a.jsxs)("section",{className:"flex justify-center gap-[0.5em] p-[2em]",children:[(0,a.jsx)("button",{onClick:()=>{s(0)},className:"border ".concat(0==e&&"bg-gray-400"),children:"View Booking"}),(0,a.jsx)("button",{onClick:()=>{s(1)},className:"border ".concat(1==e&&"bg-gray-400"),children:"Booking settings"})]}),(0,a.jsxs)("section",{children:[0==e&&(0,a.jsx)(l,{}),1==e&&(0,a.jsx)(i,{})]})]})}}},e=>{e.O(0,[441,255,358],()=>e(e.s=3677)),_N_E=e.O()}]);