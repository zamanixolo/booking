(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7],{1105:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>h});var s=t(5155),a=t(2115);let i=function(e){var r;let{select:t,viewNum:i,viewselected:l,data:n,avaiableDate:c}=e,d=new Date,[o,m]=(0,a.useState)(d.getMonth()),[u,x]=(0,a.useState)(d.getFullYear()),h=new Date(u,o,1).getDay(),b=Array.from({length:new Date(u,o+1,0).getDate()},(e,r)=>r+1),p=null!=(r=null==c?void 0:c.filter(e=>e.isActive).map(e=>e.dayOfWeek))?r:[];return(0,s.jsxs)("div",{className:"w-[90%] mx-auto my-4",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,s.jsx)("button",{onClick:()=>{0===o?(m(11),x(e=>e-1)):m(e=>e-1)},className:"px-3 py-1 bg-gray-200 rounded hover:bg-gray-300",children:"Prev"}),(0,s.jsx)("h2",{className:"text-lg font-semibold",children:new Date(u,o).toLocaleDateString("en-US",{month:"long",year:"numeric"})}),(0,s.jsx)("button",{onClick:()=>{11===o?(m(0),x(e=>e+1)):m(e=>e+1)},className:"px-3 py-1 bg-gray-200 rounded hover:bg-gray-300",children:"Next"})]}),(0,s.jsx)("div",{className:"grid grid-cols-7 text-center border-b font-semibold",children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(e=>(0,s.jsx)("div",{className:"p-2",children:e},e))}),(0,s.jsxs)("div",{className:"grid grid-cols-7 gap-0",children:[Array.from({length:h}).map((e,r)=>(0,s.jsx)("div",{className:"min-h-[5em]"},"empty-".concat(r))),b.map(e=>{let r=new Date(u,o,e).getDay(),a=((e,r,t)=>{let s=new Date(e,r,t).getDay();return p.includes(s)})(u,o,e),i=e===d.getDate()&&o===d.getMonth()&&u===d.getFullYear(),l="".concat(u,"-").concat(o+1,"-").concat(e),c=(null==n?void 0:n.date)===l;return(0,s.jsx)("div",{className:"min-h-[5em] p-2 border text-right box-border ".concat(a?"cursor-pointer hover:bg-gray-200":"bg-gray-100 text-gray-400 cursor-not-allowed"," ").concat(i?"text-red-500 font-bold":""," ").concat(c?"bg-gray-400 font-bold":""),onClick:()=>a&&t({...n,date:l,dayOfWeek:r}),children:e},e)})]}),(0,s.jsx)("br",{}),(0,s.jsx)("button",{onClick:()=>i(l-1),className:"",children:"Prev"}),(0,s.jsx)("button",{onClick:()=>i(l+1),disabled:""===n.date,children:"next"})]})},l=e=>{e.preventDefault()},n=function(e){let{viewNum:r,viewselected:t,data:a}=e;return(0,s.jsxs)("div",{className:"p-4",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Confirmation"}),(0,s.jsx)("table",{className:"table-auto border border-gray-300 w-full mb-4",children:(0,s.jsxs)("tbody",{children:[a.date&&(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{className:"border px-4 py-2 font-medium",children:"Date"}),(0,s.jsx)("td",{className:"border px-4 py-2",children:a.date})]}),a.time&&(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{className:"border px-4 py-2 font-medium",children:"Time"}),(0,s.jsx)("td",{className:"border px-4 py-2",children:a.time})]}),a.member&&(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{className:"border px-4 py-2 font-medium",children:"Member"}),(0,s.jsx)("td",{className:"border px-4 py-2",children:a.member})]}),a.price&&(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{className:"border px-4 py-2 font-medium",children:"Price"}),(0,s.jsxs)("td",{className:"border px-4 py-2",children:["R",a.price]})]})]})}),(0,s.jsxs)("form",{onSubmit:l,children:[(0,s.jsxs)("div",{className:"mb-[0.5em] align-center ",children:[(0,s.jsx)("input",{type:"text",className:"border border-gray-200 w-[60%] mx-auto",placeholder:"first name here"}),(0,s.jsx)("br",{}),(0,s.jsx)("input",{type:"text",className:"border border-gray-200 w-[60%] mx-auto",placeholder:"last name here"}),(0,s.jsx)("br",{}),(0,s.jsx)("input",{type:"email",className:"border border-gray-200 w-[60%] mx-auto",placeholder:"email here"}),(0,s.jsx)("br",{}),(0,s.jsx)("input",{type:"phone",className:"border border-gray-200 w-[60%] mx-auto",placeholder:"phone number here"})]}),(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsx)("button",{onClick:()=>r(t-1),className:"",children:"Prev"}),(0,s.jsx)("button",{type:"submit",className:"",children:"Confirm"})]})]})]})},c=function(e){let{select:r,viewNum:t,viewselected:i,data:l,bookingsetting:n}=e,[c,d]=(0,a.useState)([]);return(0,a.useEffect)(()=>{d(n[l.serviceNum].provider)},[]),(0,s.jsxs)("div",{className:"w-[90%] mx-auto",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Member"}),(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:c.map((e,t)=>{let a=(null==l?void 0:l.firstName)===e.firstName;return(0,s.jsxs)("div",{onClick:()=>r({...l,firstName:e.firstName,lastName:e.lastName}),className:"p-4 border rounded-lg cursor-pointer shadow hover:shadow-lg transition\n                ".concat(a?"bg-gray-400 border-gray-400":"bg-white"),children:[(0,s.jsx)("img",{src:"/app/next.svg",alt:e.firstName,height:200,width:200,className:"mx-auto mb-2"}),(0,s.jsxs)("h3",{className:"text-lg font-semibold text-center",children:[e.firstName," ",e.lastName]}),(0,s.jsx)("h3",{className:"text-gray-700 text-center",children:e.bio}),(0,s.jsx)("p",{className:"text-gray-500",children:e.role})]},t)})}),(0,s.jsxs)("div",{className:"",children:[(0,s.jsx)("button",{onClick:()=>t(i-1),className:"",children:"Prev"}),(0,s.jsx)("button",{onClick:()=>t(i+1),className:"",disabled:""===l.firstName,children:"Next"})]})]})},d=function(e){let{select:r,viewNum:t,viewselected:a,data:i,bookingsetting:l}=e;return(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{children:"Select Service"}),Array.isArray(l)&&l.map((e,t)=>{let a=e.service;if(!a||!1==a.isActive)return null;let l=i.serviceNum===t;return(0,s.jsx)("div",{onClick:()=>r({...i,serviceNum:t}),children:(0,s.jsxs)("div",{className:"p-4 border rounded-lg cursor-pointer shadow hover:shadow-lg transition\n                ".concat(l?"bg-gray-400 border-gray-400":"bg-white"),children:[(0,s.jsx)("h2",{children:a.name}),(0,s.jsx)("h3",{children:a.description})]})},t)}),(0,s.jsx)("div",{className:"",children:(0,s.jsx)("button",{onClick:()=>t(a+1),className:"",disabled:null===i.serviceNum,children:"Next"})})]})};var o=t(7471);let m=function(e){let{viewNum:r,viewselected:t,data:a,bookingsetting:i}=e,{isSignedIn:l,userId:n}=(0,o.d)(),c=async()=>{var e,r;if(!l)return void alert("Please sign in to complete your booking.");let t=(Array.isArray(null==(e=i[a.serviceNum])?void 0:e.provider)?i[a.serviceNum].provider:[null==(r=i[a.serviceNum])?void 0:r.provider].filter(Boolean)).find(e=>e.firstName===a.firstName);if(!t)return void alert("Provider not found!");let s={clientId:n,providerId:t.id,serviceId:i[a.serviceNum].serviceId,price:i[a.serviceNum].defaultPrice,sessionDuration:i[a.serviceNum].defaultSessionDuration,time:a.time,date:a.date,specialRequests:""};try{let e=await fetch("/app/api/booking",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}),r=await e.json();201==r.status&&alert("booking success")}catch(e){console.error("Error creating booking:",e)}};return(0,s.jsxs)("div",{className:"w-[90%] mx-auto",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Summary"}),(0,s.jsx)("table",{className:"w-full border border-gray-300 rounded-lg overflow-hidden",children:(0,s.jsxs)("tbody",{children:[a.date&&(0,s.jsxs)("tr",{className:"border-b",children:[(0,s.jsx)("td",{className:"p-2 font-semibold",children:"Date"}),(0,s.jsx)("td",{className:"p-2",children:a.date})]}),a.time&&(0,s.jsxs)("tr",{className:"border-b",children:[(0,s.jsx)("td",{className:"p-2 font-semibold",children:"Time"}),(0,s.jsx)("td",{className:"p-2",children:a.time})]}),a.firstName&&(0,s.jsxs)("tr",{className:"border-b",children:[(0,s.jsx)("td",{className:"p-2 font-semibold",children:"Member"}),(0,s.jsxs)("td",{className:"p-2",children:[a.firstName," ",a.lastName]})]}),i[0].defaultPrice&&(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{className:"p-2 font-semibold",children:"Price"}),(0,s.jsxs)("td",{className:"p-2",children:["R",i[a.serviceNum].defaultPrice]})]})]})}),(0,s.jsxs)("div",{className:"flex ",children:[(0,s.jsx)("button",{onClick:()=>r(t-1),className:"",children:"Prev"}),(0,s.jsx)("button",{onClick:c,children:"comfirm"})]})]})},u=function(e){var r,t;let{select:a,viewNum:i,viewselected:l,data:n,avaiableDate:c,bookingsetting:d}=e,o=(null==(r=c[n.dayOfWeek])?void 0:r.startTime)||"09:00",m=(null==(t=c[n.dayOfWeek])?void 0:t.endTime)||"17:00",u=function(e,r,t){let s=[],[a,i]=e.split(":").map(Number),[l,n]=r.split(":").map(Number),c=new Date;c.setHours(a,i,0,0);let d=new Date;for(d.setHours(l,n,0,0);c<=d;){let e=c.getHours().toString().padStart(2,"0"),r=c.getMinutes().toString().padStart(2,"0");s.push("".concat(e,":").concat(r)),c.setMinutes(c.getMinutes()+t)}return s}(o,m,d[n.serviceNum].defaultSessionDuration||60);return(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{children:"Time"}),(0,s.jsx)("div",{className:"grid grid-cols-3 gap-3",children:u.map(e=>(0,s.jsx)("button",{onClick:()=>a({...n,time:e}),className:"px-4 py-2 rounded-lg border \n              ".concat(n.time===e?"bg-blue-500 text-white border-blue-600":"bg-gray-100 hover:bg-gray-200"),children:e},e))}),(0,s.jsx)("br",{}),(0,s.jsx)("button",{onClick:()=>{i(l-1)},children:"prev"}),(0,s.jsx)("button",{onClick:()=>{i(l+1)},disabled:""===n.time,children:"next"})]})};var x=t(5181);let h=()=>{let[e,r]=(0,a.useState)({dayOfWeek:null,serviceNum:null,date:"",time:"",firstName:"",lastName:"",price:""}),[t,l]=(0,a.useState)([]),[o,h]=(0,a.useState)([]),[b,p]=(0,a.useState)(!0),[N,j]=(0,a.useState)(0),g=async()=>{let e=await fetch("/app/api/operating-hours");l(await e.json())},v=async()=>{let e=await fetch("/app/api/booking-settings"),r=await fetch("/app/api/services"),t=await fetch("/app/api/team"),s=await e.json(),a=await r.json(),i=await t.json(),l=s.map(e=>{let r=a.find(r=>r.id===e.serviceId)||null,t=(0,x.A)(e.providerIds.toString()),s=i.filter(e=>null==t?void 0:t.includes(e.id))||[];return{...e,service:r,provider:s}});console.log(l),h(l),p(!1)};return((0,a.useEffect)(()=>{g(),v()},[]),b)?(0,s.jsx)("div",{children:"... Loading"}):(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("h1",{children:"Book Time"}),(()=>{switch(N){case 0:default:return(0,s.jsx)(d,{select:r,viewNum:j,data:e,bookingsetting:o,viewselected:N});case 1:return(0,s.jsx)(c,{select:r,data:e,viewNum:j,bookingsetting:o,viewselected:N});case 2:return(0,s.jsx)(i,{select:r,avaiableDate:t,data:e,viewNum:j,viewselected:N});case 3:return(0,s.jsx)(u,{select:r,avaiableDate:t,data:e,bookingsetting:o,viewNum:j,viewselected:N});case 4:return(0,s.jsx)(m,{viewNum:j,data:e,bookingsetting:o,viewselected:N});case 5:return(0,s.jsx)(n,{viewNum:j,data:e,viewselected:N})}})()]})}},2796:(e,r,t)=>{Promise.resolve().then(t.bind(t,1105))},5181:(e,r,t)=>{"use strict";function s(e){if(!e)return[];try{let r=JSON.parse(e);if(Array.isArray(r))return r;if("string"==typeof r)return[r]}catch(e){}return e.includes(",")?e.split(",").map(e=>e.trim()).filter(Boolean):[e.trim()]}t.d(r,{A:()=>s})}},e=>{e.O(0,[471,441,255,358],()=>e(e.s=2796)),_N_E=e.O()}]);