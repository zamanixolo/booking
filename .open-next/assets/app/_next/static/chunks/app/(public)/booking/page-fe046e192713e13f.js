(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7],{1105:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>h});var s=r(5155),a=r(2115);let i=function(e){var t;let{select:r,viewNum:i,viewselected:l,data:n,avaiableDate:d}=e,c=new Date,[o,m]=(0,a.useState)(c.getMonth()),[u,x]=(0,a.useState)(c.getFullYear()),h=new Date(u,o,1).getDay(),b=Array.from({length:new Date(u,o+1,0).getDate()},(e,t)=>t+1),N=null!=(t=null==d?void 0:d.filter(e=>e.isActive).map(e=>e.dayOfWeek))?t:[];return(0,s.jsxs)("div",{className:"w-[90%] mx-auto my-4",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,s.jsx)("button",{onClick:()=>{0===o?(m(11),x(e=>e-1)):m(e=>e-1)},className:"px-3 py-1 bg-gray-200 rounded hover:bg-gray-300",children:"Prev"}),(0,s.jsx)("h2",{className:"text-lg font-semibold",children:new Date(u,o).toLocaleDateString("en-US",{month:"long",year:"numeric"})}),(0,s.jsx)("button",{onClick:()=>{11===o?(m(0),x(e=>e+1)):m(e=>e+1)},className:"px-3 py-1 bg-gray-200 rounded hover:bg-gray-300",children:"Next"})]}),(0,s.jsx)("div",{className:"grid grid-cols-7 text-center border-b font-semibold",children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(e=>(0,s.jsx)("div",{className:"p-2",children:e},e))}),(0,s.jsxs)("div",{className:"grid grid-cols-7 gap-0",children:[Array.from({length:h}).map((e,t)=>(0,s.jsx)("div",{className:"min-h-[5em]"},"empty-".concat(t))),b.map(e=>{let t=new Date(u,o,e).getDay(),a=((e,t,r)=>{let s=new Date(e,t,r).getDay();return N.includes(s)})(u,o,e),i=e===c.getDate()&&o===c.getMonth()&&u===c.getFullYear(),l="".concat(u,"-").concat(o+1,"-").concat(e),d=(null==n?void 0:n.date)===l;return(0,s.jsx)("div",{className:"min-h-[5em] p-2 border text-right box-border ".concat(a?"cursor-pointer hover:bg-gray-200":"bg-gray-100 text-gray-400 cursor-not-allowed"," ").concat(i?"text-red-500 font-bold":""," ").concat(d?"bg-gray-400 font-bold":""),onClick:()=>a&&r({...n,date:l,dayOfWeek:t}),children:e},e)})]}),(0,s.jsx)("br",{}),(0,s.jsx)("button",{onClick:()=>i(l-1),className:"",children:"Prev"}),(0,s.jsx)("button",{onClick:()=>i(l+1),disabled:""===n.date,children:"next"})]})},l=e=>{e.preventDefault()},n=function(e){let{viewNum:t,viewselected:r,data:a}=e;return(0,s.jsxs)("div",{className:"p-4",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Confirmation"}),(0,s.jsx)("table",{className:"table-auto border border-gray-300 w-full mb-4",children:(0,s.jsxs)("tbody",{children:[a.date&&(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{className:"border px-4 py-2 font-medium",children:"Date"}),(0,s.jsx)("td",{className:"border px-4 py-2",children:a.date})]}),a.time&&(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{className:"border px-4 py-2 font-medium",children:"Time"}),(0,s.jsx)("td",{className:"border px-4 py-2",children:a.time})]}),a.member&&(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{className:"border px-4 py-2 font-medium",children:"Member"}),(0,s.jsx)("td",{className:"border px-4 py-2",children:a.member})]}),a.price&&(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{className:"border px-4 py-2 font-medium",children:"Price"}),(0,s.jsxs)("td",{className:"border px-4 py-2",children:["R",a.price]})]})]})}),(0,s.jsxs)("form",{onSubmit:l,children:[(0,s.jsxs)("div",{className:"mb-[0.5em] align-center ",children:[(0,s.jsx)("input",{type:"text",className:"border border-gray-200 w-[60%] mx-auto",placeholder:"first name here"}),(0,s.jsx)("br",{}),(0,s.jsx)("input",{type:"text",className:"border border-gray-200 w-[60%] mx-auto",placeholder:"last name here"}),(0,s.jsx)("br",{}),(0,s.jsx)("input",{type:"email",className:"border border-gray-200 w-[60%] mx-auto",placeholder:"email here"}),(0,s.jsx)("br",{}),(0,s.jsx)("input",{type:"phone",className:"border border-gray-200 w-[60%] mx-auto",placeholder:"phone number here"})]}),(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsx)("button",{onClick:()=>t(r-1),className:"",children:"Prev"}),(0,s.jsx)("button",{type:"submit",className:"",children:"Confirm"})]})]})]})};var d=r(5239);let c=function(e){let{select:t,viewNum:r,viewselected:i,data:l,bookingsetting:n}=e,[c,o]=(0,a.useState)([]);return(0,a.useEffect)(()=>{o(n[l.serviceNum].providers)},[]),(0,s.jsxs)("div",{className:"w-[90%] mx-auto",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Member"}),(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:c.map((e,r)=>{let a=(null==l?void 0:l.firstName)===e.firstName;return(0,s.jsxs)("div",{onClick:()=>t({...l,firstName:e.firstName,lastName:e.lastName}),className:"p-4 border rounded-lg cursor-pointer shadow hover:shadow-lg transition\n                ".concat(a?"bg-gray-400 border-gray-400":"bg-white"),children:[(0,s.jsx)(d.default,{src:"next.svg",alt:e.firstName,height:200,width:200,className:"mx-auto mb-2"}),(0,s.jsxs)("h3",{className:"text-lg font-semibold text-center",children:[e.firstName," ",e.lastName]}),(0,s.jsx)("h3",{className:"text-gray-700 text-center",children:e.bio}),(0,s.jsx)("p",{className:"text-gray-500",children:e.role})]},r)})}),(0,s.jsxs)("div",{className:"",children:[(0,s.jsx)("button",{onClick:()=>r(i-1),className:"",children:"Prev"}),(0,s.jsx)("button",{onClick:()=>r(i+1),className:"",disabled:""===l.firstName,children:"Next"})]})]})},o=function(e){let{select:t,viewNum:r,viewselected:a,data:i,bookingsetting:l}=e;return(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{children:"Select Service"}),Array.isArray(l)&&l.map((e,r)=>{let a=e.service;if(!a||!1==a.isActive)return null;let l=i.serviceNum===r;return(0,s.jsx)("div",{onClick:()=>t({...i,serviceNum:r}),children:(0,s.jsxs)("div",{className:"p-4 border rounded-lg cursor-pointer shadow hover:shadow-lg transition\n                ".concat(l?"bg-gray-400 border-gray-400":"bg-white"),children:[(0,s.jsx)("h2",{children:a.name}),(0,s.jsx)("h3",{children:a.description})]})},r)}),(0,s.jsx)("div",{className:"",children:(0,s.jsx)("button",{onClick:()=>r(a+1),className:"",disabled:null===i.serviceNum,children:"Next"})})]})};var m=r(7471);let u=function(e){let{viewNum:t,viewselected:r,data:a,bookingsetting:i}=e,{isSignedIn:l,userId:n}=(0,m.d)(),d=async()=>{var e,t;if(!l)return void alert("Please sign in to complete your booking.");let r=(Array.isArray(null==(e=i[a.serviceNum])?void 0:e.providers)?i[a.serviceNum].providers:[null==(t=i[a.serviceNum])?void 0:t.providers].filter(Boolean)).find(e=>e.firstName===a.firstName);if(!r)return void alert("Provider not found!");let s={clientId:n,providerId:r.id,serviceId:i[a.serviceNum].serviceId,price:i[a.serviceNum].defaultPrice,sessionDuration:i[a.serviceNum].defaultSessionDuration,time:a.time,date:a.date,specialRequests:""};try{let e=await fetch("/api/booking",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});await e.json()}catch(e){console.error("Error creating booking:",e)}};return(0,s.jsxs)("div",{className:"w-[90%] mx-auto",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Summary"}),(0,s.jsx)("table",{className:"w-full border border-gray-300 rounded-lg overflow-hidden",children:(0,s.jsxs)("tbody",{children:[a.date&&(0,s.jsxs)("tr",{className:"border-b",children:[(0,s.jsx)("td",{className:"p-2 font-semibold",children:"Date"}),(0,s.jsx)("td",{className:"p-2",children:a.date})]}),a.time&&(0,s.jsxs)("tr",{className:"border-b",children:[(0,s.jsx)("td",{className:"p-2 font-semibold",children:"Time"}),(0,s.jsx)("td",{className:"p-2",children:a.time})]}),a.firstName&&(0,s.jsxs)("tr",{className:"border-b",children:[(0,s.jsx)("td",{className:"p-2 font-semibold",children:"Member"}),(0,s.jsxs)("td",{className:"p-2",children:[a.firstName," ",a.lastName]})]}),i[0].defaultPrice&&(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{className:"p-2 font-semibold",children:"Price"}),(0,s.jsxs)("td",{className:"p-2",children:["R",i[a.serviceNum].defaultPrice]})]})]})}),(0,s.jsxs)("div",{className:"flex ",children:[(0,s.jsx)("button",{onClick:()=>t(r-1),className:"",children:"Prev"}),(0,s.jsx)("button",{onClick:d,children:"comfirm"})]})]})},x=function(e){var t,r;let{select:a,viewNum:i,viewselected:l,data:n,avaiableDate:d,bookingsetting:c}=e,o=(null==(t=d[n.dayOfWeek])?void 0:t.startTime)||"09:00",m=(null==(r=d[n.dayOfWeek])?void 0:r.endTime)||"17:00",u=function(e,t,r){let s=[],[a,i]=e.split(":").map(Number),[l,n]=t.split(":").map(Number),d=new Date;d.setHours(a,i,0,0);let c=new Date;for(c.setHours(l,n,0,0);d<=c;){let e=d.getHours().toString().padStart(2,"0"),t=d.getMinutes().toString().padStart(2,"0");s.push("".concat(e,":").concat(t)),d.setMinutes(d.getMinutes()+r)}return s}(o,m,c[n.serviceNum].defaultSessionDuration||60);return(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{children:"Time"}),(0,s.jsx)("div",{className:"grid grid-cols-3 gap-3",children:u.map(e=>(0,s.jsx)("button",{onClick:()=>a({...n,time:e}),className:"px-4 py-2 rounded-lg border \n              ".concat(n.time===e?"bg-blue-500 text-white border-blue-600":"bg-gray-100 hover:bg-gray-200"),children:e},e))}),(0,s.jsx)("br",{}),(0,s.jsx)("button",{onClick:()=>{i(l-1)},children:"prev"}),(0,s.jsx)("button",{onClick:()=>{i(l+1)},disabled:""===n.time,children:"next"})]})},h=function(){let[e,t]=(0,a.useState)({dayOfWeek:1,serviceNum:null,date:"",time:"",firstName:"",lastName:"",price:""}),[r,l]=(0,a.useState)([]),[d,m]=(0,a.useState)([]),[h,b]=(0,a.useState)(!0),N=async()=>{let e=await fetch("/api/operating-hours");l(await e.json())},g=async()=>{let e=await fetch("/api/booking-settings");m(await e.json()),b(!1)};(0,a.useEffect)(()=>{N(),g()},[]);let[p,j]=(0,a.useState)(0);return h?(0,s.jsx)("div",{children:"... Loading"}):(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("h1",{children:"Book Time"}),(()=>{switch(p){case 0:default:return(0,s.jsx)(o,{select:t,viewNum:j,data:e,bookingsetting:d,viewselected:p});case 1:return(0,s.jsx)(c,{select:t,data:e,viewNum:j,bookingsetting:d,viewselected:p});case 2:return(0,s.jsx)(i,{select:t,avaiableDate:r,data:e,viewNum:j,viewselected:p});case 3:return(0,s.jsx)(x,{select:t,avaiableDate:r,data:e,bookingsetting:d,viewNum:j,viewselected:p});case 4:return(0,s.jsx)(u,{viewNum:j,data:e,bookingsetting:d,viewselected:p});case 5:return(0,s.jsx)(n,{viewNum:j,data:e,viewselected:p})}})()]})}},2796:(e,t,r)=>{Promise.resolve().then(r.bind(r,1105))},4652:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),!function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{default:function(){return d},getImageProps:function(){return n}});let s=r(8140),a=r(5040),i=r(1356),l=s._(r(1124));function n(e){let{props:t}=(0,a.getImgProps)(e,{defaultLoader:l.default,imgConf:{deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/app/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!1}});for(let[e,r]of Object.entries(t))void 0===r&&delete t[e];return{props:t}}let d=i.Image},5239:(e,t,r)=>{"use strict";r.d(t,{default:()=>a.a});var s=r(4652),a=r.n(s)},7471:(e,t,r)=>{"use strict";r.d(t,{d:()=>d});var s=r(3275),a=r(633),i=r(9268),l=r(2115);let n=l.createContext(null);function d(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,i.useRouter)(),r=l.useContext(n),d=r;return(r&&"then"in r&&(d=l.use(r)),"undefined"!=typeof window)?(0,s.As)({...d,...e}):t?(0,s.As)(e):(0,a.hP)({...d,...e})}}},e=>{e.O(0,[134,356,441,255,358],()=>e(e.s=2796)),_N_E=e.O()}]);