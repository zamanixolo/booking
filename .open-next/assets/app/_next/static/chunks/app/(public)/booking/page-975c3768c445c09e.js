(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7],{415:(e,t,s)=>{Promise.resolve().then(s.bind(s,1105))},1105:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>x});var r=s(5155),a=s(2115);let i=function(e){var t;let{select:s,viewNum:i,viewselected:l,data:n,avaiableDate:d}=e,c=new Date,[o,m]=(0,a.useState)(c.getMonth()),[u,x]=(0,a.useState)(c.getFullYear()),h=new Date(u,o,1).getDay(),b=Array.from({length:new Date(u,o+1,0).getDate()},(e,t)=>t+1),N=null!=(t=null==d?void 0:d.filter(e=>e.isActive).map(e=>e.dayOfWeek))?t:[];return(0,r.jsxs)("div",{className:"w-[90%] mx-auto my-4",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,r.jsx)("button",{onClick:()=>{0===o?(m(11),x(e=>e-1)):m(e=>e-1)},className:"px-3 py-1 bg-gray-200 rounded hover:bg-gray-300",children:"Prev"}),(0,r.jsx)("h2",{className:"text-lg font-semibold",children:new Date(u,o).toLocaleDateString("en-US",{month:"long",year:"numeric"})}),(0,r.jsx)("button",{onClick:()=>{11===o?(m(0),x(e=>e+1)):m(e=>e+1)},className:"px-3 py-1 bg-gray-200 rounded hover:bg-gray-300",children:"Next"})]}),(0,r.jsx)("div",{className:"grid grid-cols-7 text-center border-b font-semibold",children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(e=>(0,r.jsx)("div",{className:"p-2",children:e},e))}),(0,r.jsxs)("div",{className:"grid grid-cols-7 gap-0",children:[Array.from({length:h}).map((e,t)=>(0,r.jsx)("div",{className:"min-h-[5em]"},"empty-".concat(t))),b.map(e=>{let t=new Date(u,o,e).getDay(),a=((e,t,s)=>{let r=new Date(e,t,s).getDay();return N.includes(r)})(u,o,e),i=e===c.getDate()&&o===c.getMonth()&&u===c.getFullYear(),l="".concat(u,"-").concat(o+1,"-").concat(e),d=(null==n?void 0:n.date)===l;return(0,r.jsx)("div",{className:"min-h-[5em] p-2 border text-right box-border ".concat(a?"cursor-pointer hover:bg-gray-200":"bg-gray-100 text-gray-400 cursor-not-allowed"," ").concat(i?"text-red-500 font-bold":""," ").concat(d?"bg-gray-400 font-bold":""),onClick:()=>a&&s({...n,date:l,dayOfWeek:t}),children:e},e)})]}),(0,r.jsx)("br",{}),(0,r.jsx)("button",{onClick:()=>i(l-1),className:"",children:"Prev"}),(0,r.jsx)("button",{onClick:()=>i(l+1),disabled:""===n.date,children:"next"})]})},l=e=>{e.preventDefault()},n=function(e){let{viewNum:t,viewselected:s,data:a}=e;return(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Confirmation"}),(0,r.jsx)("table",{className:"table-auto border border-gray-300 w-full mb-4",children:(0,r.jsxs)("tbody",{children:[a.date&&(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{className:"border px-4 py-2 font-medium",children:"Date"}),(0,r.jsx)("td",{className:"border px-4 py-2",children:a.date})]}),a.time&&(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{className:"border px-4 py-2 font-medium",children:"Time"}),(0,r.jsx)("td",{className:"border px-4 py-2",children:a.time})]}),a.member&&(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{className:"border px-4 py-2 font-medium",children:"Member"}),(0,r.jsx)("td",{className:"border px-4 py-2",children:a.member})]}),a.price&&(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{className:"border px-4 py-2 font-medium",children:"Price"}),(0,r.jsxs)("td",{className:"border px-4 py-2",children:["R",a.price]})]})]})}),(0,r.jsxs)("form",{onSubmit:l,children:[(0,r.jsxs)("div",{className:"mb-[0.5em] align-center ",children:[(0,r.jsx)("input",{type:"text",className:"border border-gray-200 w-[60%] mx-auto",placeholder:"first name here"}),(0,r.jsx)("br",{}),(0,r.jsx)("input",{type:"text",className:"border border-gray-200 w-[60%] mx-auto",placeholder:"last name here"}),(0,r.jsx)("br",{}),(0,r.jsx)("input",{type:"email",className:"border border-gray-200 w-[60%] mx-auto",placeholder:"email here"}),(0,r.jsx)("br",{}),(0,r.jsx)("input",{type:"phone",className:"border border-gray-200 w-[60%] mx-auto",placeholder:"phone number here"})]}),(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("button",{onClick:()=>t(s-1),className:"",children:"Prev"}),(0,r.jsx)("button",{type:"submit",className:"",children:"Confirm"})]})]})]})},d=function(e){let{select:t,viewNum:s,viewselected:i,data:l,bookingsetting:n}=e,[d,c]=(0,a.useState)([]);return(0,a.useEffect)(()=>{c(n[l.serviceNum].providers)},[]),(0,r.jsxs)("div",{className:"w-[90%] mx-auto",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Member"}),(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:d.map((e,s)=>{let a=(null==l?void 0:l.firstName)===e.firstName;return(0,r.jsxs)("div",{onClick:()=>t({...l,firstName:e.firstName,lastName:e.lastName}),className:"p-4 border rounded-lg cursor-pointer shadow hover:shadow-lg transition\n                ".concat(a?"bg-gray-400 border-gray-400":"bg-white"),children:[(0,r.jsx)("img",{src:"next.svg",alt:e.firstName,height:200,width:200,className:"mx-auto mb-2"}),(0,r.jsxs)("h3",{className:"text-lg font-semibold text-center",children:[e.firstName," ",e.lastName]}),(0,r.jsx)("h3",{className:"text-gray-700 text-center",children:e.bio}),(0,r.jsx)("p",{className:"text-gray-500",children:e.role})]},s)})}),(0,r.jsxs)("div",{className:"",children:[(0,r.jsx)("button",{onClick:()=>s(i-1),className:"",children:"Prev"}),(0,r.jsx)("button",{onClick:()=>s(i+1),className:"",disabled:""===l.firstName,children:"Next"})]})]})},c=function(e){let{select:t,viewNum:s,viewselected:a,data:i,bookingsetting:l}=e;return(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{children:"Select Service"}),Array.isArray(l)&&l.map((e,s)=>{let a=e.service;if(!a||!1==a.isActive)return null;let l=i.serviceNum===s;return(0,r.jsx)("div",{onClick:()=>t({...i,serviceNum:s}),children:(0,r.jsxs)("div",{className:"p-4 border rounded-lg cursor-pointer shadow hover:shadow-lg transition\n                ".concat(l?"bg-gray-400 border-gray-400":"bg-white"),children:[(0,r.jsx)("h2",{children:a.name}),(0,r.jsx)("h3",{children:a.description})]})},s)}),(0,r.jsx)("div",{className:"",children:(0,r.jsx)("button",{onClick:()=>s(a+1),className:"",disabled:null===i.serviceNum,children:"Next"})})]})};var o=s(7471);let m=function(e){let{viewNum:t,viewselected:s,data:a,bookingsetting:i}=e,{isSignedIn:l,userId:n}=(0,o.d)(),d=async()=>{var e,t;if(!l)return void alert("Please sign in to complete your booking.");let s=(Array.isArray(null==(e=i[a.serviceNum])?void 0:e.providers)?i[a.serviceNum].providers:[null==(t=i[a.serviceNum])?void 0:t.providers].filter(Boolean)).find(e=>e.firstName===a.firstName);if(!s)return void alert("Provider not found!");let r={clientId:n,providerId:s.id,serviceId:i[a.serviceNum].serviceId,price:i[a.serviceNum].defaultPrice,sessionDuration:i[a.serviceNum].defaultSessionDuration,time:a.time,date:a.date,specialRequests:""};try{let e=await fetch("/api/booking",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});await e.json()}catch(e){console.error("Error creating booking:",e)}};return(0,r.jsxs)("div",{className:"w-[90%] mx-auto",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Summary"}),(0,r.jsx)("table",{className:"w-full border border-gray-300 rounded-lg overflow-hidden",children:(0,r.jsxs)("tbody",{children:[a.date&&(0,r.jsxs)("tr",{className:"border-b",children:[(0,r.jsx)("td",{className:"p-2 font-semibold",children:"Date"}),(0,r.jsx)("td",{className:"p-2",children:a.date})]}),a.time&&(0,r.jsxs)("tr",{className:"border-b",children:[(0,r.jsx)("td",{className:"p-2 font-semibold",children:"Time"}),(0,r.jsx)("td",{className:"p-2",children:a.time})]}),a.firstName&&(0,r.jsxs)("tr",{className:"border-b",children:[(0,r.jsx)("td",{className:"p-2 font-semibold",children:"Member"}),(0,r.jsxs)("td",{className:"p-2",children:[a.firstName," ",a.lastName]})]}),i[0].defaultPrice&&(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{className:"p-2 font-semibold",children:"Price"}),(0,r.jsxs)("td",{className:"p-2",children:["R",i[a.serviceNum].defaultPrice]})]})]})}),(0,r.jsxs)("div",{className:"flex ",children:[(0,r.jsx)("button",{onClick:()=>t(s-1),className:"",children:"Prev"}),(0,r.jsx)("button",{onClick:d,children:"comfirm"})]})]})},u=function(e){var t,s;let{select:a,viewNum:i,viewselected:l,data:n,avaiableDate:d,bookingsetting:c}=e,o=(null==(t=d[n.dayOfWeek])?void 0:t.startTime)||"09:00",m=(null==(s=d[n.dayOfWeek])?void 0:s.endTime)||"17:00",u=function(e,t,s){let r=[],[a,i]=e.split(":").map(Number),[l,n]=t.split(":").map(Number),d=new Date;d.setHours(a,i,0,0);let c=new Date;for(c.setHours(l,n,0,0);d<=c;){let e=d.getHours().toString().padStart(2,"0"),t=d.getMinutes().toString().padStart(2,"0");r.push("".concat(e,":").concat(t)),d.setMinutes(d.getMinutes()+s)}return r}(o,m,c[n.serviceNum].defaultSessionDuration||60);return(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{children:"Time"}),(0,r.jsx)("div",{className:"grid grid-cols-3 gap-3",children:u.map(e=>(0,r.jsx)("button",{onClick:()=>a({...n,time:e}),className:"px-4 py-2 rounded-lg border \n              ".concat(n.time===e?"bg-blue-500 text-white border-blue-600":"bg-gray-100 hover:bg-gray-200"),children:e},e))}),(0,r.jsx)("br",{}),(0,r.jsx)("button",{onClick:()=>{i(l-1)},children:"prev"}),(0,r.jsx)("button",{onClick:()=>{i(l+1)},disabled:""===n.time,children:"next"})]})},x=()=>{let[e,t]=(0,a.useState)({dayOfWeek:null,serviceNum:null,date:"",time:"",firstName:"",lastName:"",price:""}),[s,l]=(0,a.useState)([]),[o,x]=(0,a.useState)([]),[h,b]=(0,a.useState)(!0),[N,j]=(0,a.useState)(0),g=async()=>{let e=await fetch("/api/operating-hours");l(await e.json())},p=async()=>{let e=await fetch("/api/booking-settings");x(await e.json()),b(!1)};return((0,a.useEffect)(()=>{g(),p()},[]),h)?(0,r.jsx)("div",{children:"... Loading"}):(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("h1",{children:"Book Time"}),(()=>{switch(N){case 0:default:return(0,r.jsx)(c,{select:t,viewNum:j,data:e,bookingsetting:o,viewselected:N});case 1:return(0,r.jsx)(d,{select:t,data:e,viewNum:j,bookingsetting:o,viewselected:N});case 2:return(0,r.jsx)(i,{select:t,avaiableDate:s,data:e,viewNum:j,viewselected:N});case 3:return(0,r.jsx)(u,{select:t,avaiableDate:s,data:e,bookingsetting:o,viewNum:j,viewselected:N});case 4:return(0,r.jsx)(m,{viewNum:j,data:e,bookingsetting:o,viewselected:N});case 5:return(0,r.jsx)(n,{viewNum:j,data:e,viewselected:N})}})()]})}},7471:(e,t,s)=>{"use strict";s.d(t,{d:()=>d});var r=s(8649),a=s(633),i=s(9268),l=s(2115);let n=l.createContext(null);function d(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,i.useRouter)(),s=l.useContext(n),d=s;return(s&&"then"in s&&(d=l.use(s)),"undefined"!=typeof window)?(0,r.As)({...d,...e}):t?(0,r.As)(e):(0,a.hP)({...d,...e})}}},e=>{e.O(0,[864,441,255,358],()=>e(e.s=415)),_N_E=e.O()}]);