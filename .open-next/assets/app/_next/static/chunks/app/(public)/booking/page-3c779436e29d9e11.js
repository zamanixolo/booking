(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7],{415:(e,t,r)=>{Promise.resolve().then(r.bind(r,1105))},1105:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>h});var s=r(5155),a=r(2115);let i=function(e){var t;let{select:r,viewNum:i,viewselected:l,data:n,avaiableDate:d}=e,c=new Date,[o,m]=(0,a.useState)(c.getMonth()),[u,x]=(0,a.useState)(c.getFullYear()),h=new Date(u,o,1).getDay(),b=Array.from({length:new Date(u,o+1,0).getDate()},(e,t)=>t+1),p=null!=(t=null==d?void 0:d.filter(e=>e.isActive).map(e=>e.dayOfWeek))?t:[];return(0,s.jsxs)("div",{className:"w-[90%] mx-auto my-4",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,s.jsx)("button",{onClick:()=>{0===o?(m(11),x(e=>e-1)):m(e=>e-1)},className:"px-3 py-1 bg-gray-200 rounded hover:bg-gray-300",children:"Prev"}),(0,s.jsx)("h2",{className:"text-lg font-semibold",children:new Date(u,o).toLocaleDateString("en-US",{month:"long",year:"numeric"})}),(0,s.jsx)("button",{onClick:()=>{11===o?(m(0),x(e=>e+1)):m(e=>e+1)},className:"px-3 py-1 bg-gray-200 rounded hover:bg-gray-300",children:"Next"})]}),(0,s.jsx)("div",{className:"grid grid-cols-7 text-center border-b font-semibold",children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(e=>(0,s.jsx)("div",{className:"p-2",children:e},e))}),(0,s.jsxs)("div",{className:"grid grid-cols-7 gap-0",children:[Array.from({length:h}).map((e,t)=>(0,s.jsx)("div",{className:"min-h-[5em]"},"empty-".concat(t))),b.map(e=>{let t=new Date(u,o,e).getDay(),a=((e,t,r)=>{let s=new Date(e,t,r).getDay();return p.includes(s)})(u,o,e),i=e===c.getDate()&&o===c.getMonth()&&u===c.getFullYear(),l="".concat(u,"-").concat(o+1,"-").concat(e),d=(null==n?void 0:n.date)===l;return(0,s.jsx)("div",{className:"min-h-[5em] p-2 border text-right box-border ".concat(a?"cursor-pointer hover:bg-gray-200":"bg-gray-100 text-gray-400 cursor-not-allowed"," ").concat(i?"text-red-500 font-bold":""," ").concat(d?"bg-gray-400 font-bold":""),onClick:()=>a&&r({...n,date:l,dayOfWeek:t}),children:e},e)})]}),(0,s.jsx)("br",{}),(0,s.jsx)("button",{onClick:()=>i(l-1),className:"",children:"Prev"}),(0,s.jsx)("button",{onClick:()=>i(l+1),disabled:""===n.date,children:"next"})]})},l=e=>{e.preventDefault()},n=function(e){let{viewNum:t,viewselected:r,data:a}=e;return(0,s.jsxs)("div",{className:"p-4",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Confirmation"}),(0,s.jsx)("table",{className:"table-auto border border-gray-300 w-full mb-4",children:(0,s.jsxs)("tbody",{children:[a.date&&(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{className:"border px-4 py-2 font-medium",children:"Date"}),(0,s.jsx)("td",{className:"border px-4 py-2",children:a.date})]}),a.time&&(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{className:"border px-4 py-2 font-medium",children:"Time"}),(0,s.jsx)("td",{className:"border px-4 py-2",children:a.time})]}),a.member&&(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{className:"border px-4 py-2 font-medium",children:"Member"}),(0,s.jsx)("td",{className:"border px-4 py-2",children:a.member})]}),a.price&&(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{className:"border px-4 py-2 font-medium",children:"Price"}),(0,s.jsxs)("td",{className:"border px-4 py-2",children:["R",a.price]})]})]})}),(0,s.jsxs)("form",{onSubmit:l,children:[(0,s.jsxs)("div",{className:"mb-[0.5em] align-center ",children:[(0,s.jsx)("input",{type:"text",className:"border border-gray-200 w-[60%] mx-auto",placeholder:"first name here"}),(0,s.jsx)("br",{}),(0,s.jsx)("input",{type:"text",className:"border border-gray-200 w-[60%] mx-auto",placeholder:"last name here"}),(0,s.jsx)("br",{}),(0,s.jsx)("input",{type:"email",className:"border border-gray-200 w-[60%] mx-auto",placeholder:"email here"}),(0,s.jsx)("br",{}),(0,s.jsx)("input",{type:"phone",className:"border border-gray-200 w-[60%] mx-auto",placeholder:"phone number here"})]}),(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsx)("button",{onClick:()=>t(r-1),className:"",children:"Prev"}),(0,s.jsx)("button",{type:"submit",className:"",children:"Confirm"})]})]})]})},d=function(e){let{select:t,viewNum:r,viewselected:i,data:l,bookingsetting:n}=e,[d,c]=(0,a.useState)([]);return(0,a.useEffect)(()=>{c(n[l.serviceNum].provider)},[]),(0,s.jsxs)("div",{className:"w-[90%] mx-auto",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Member"}),(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:d.map((e,r)=>{let a=(null==l?void 0:l.firstName)===e.firstName;return(0,s.jsxs)("div",{onClick:()=>t({...l,firstName:e.firstName,lastName:e.lastName}),className:"p-4 border rounded-lg cursor-pointer shadow hover:shadow-lg transition\n                ".concat(a?"bg-gray-400 border-gray-400":"bg-white"),children:[(0,s.jsx)("img",{src:"/app/next.svg",alt:e.firstName,height:200,width:200,className:"mx-auto mb-2"}),(0,s.jsxs)("h3",{className:"text-lg font-semibold text-center",children:[e.firstName," ",e.lastName]}),(0,s.jsx)("h3",{className:"text-gray-700 text-center",children:e.bio}),(0,s.jsx)("p",{className:"text-gray-500",children:e.role})]},r)})}),(0,s.jsxs)("div",{className:"",children:[(0,s.jsx)("button",{onClick:()=>r(i-1),className:"",children:"Prev"}),(0,s.jsx)("button",{onClick:()=>r(i+1),className:"",disabled:""===l.firstName,children:"Next"})]})]})},c=function(e){let{select:t,viewNum:r,viewselected:a,data:i,bookingsetting:l}=e;return(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{children:"Select Service"}),Array.isArray(l)&&l.map((e,r)=>{let a=e.service;if(!a||!1==a.isActive)return null;let l=i.serviceNum===r;return(0,s.jsx)("div",{onClick:()=>t({...i,serviceNum:r}),children:(0,s.jsxs)("div",{className:"p-4 border rounded-lg cursor-pointer shadow hover:shadow-lg transition\n                ".concat(l?"bg-gray-400 border-gray-400":"bg-white"),children:[(0,s.jsx)("h2",{children:a.name}),(0,s.jsx)("h3",{children:a.description})]})},r)}),(0,s.jsx)("div",{className:"",children:(0,s.jsx)("button",{onClick:()=>r(a+1),className:"",disabled:null===i.serviceNum,children:"Next"})})]})};var o=r(7471);let m=function(e){let{viewNum:t,viewselected:r,data:a,bookingsetting:i}=e,{isSignedIn:l,userId:n}=(0,o.d)(),d=async()=>{var e,t;if(!l)return void alert("Please sign in to complete your booking.");let r=(Array.isArray(null==(e=i[a.serviceNum])?void 0:e.provider)?i[a.serviceNum].provider:[null==(t=i[a.serviceNum])?void 0:t.provider].filter(Boolean)).find(e=>e.firstName===a.firstName);if(!r)return void alert("Provider not found!");let s={clientId:n,providerId:r.id,serviceId:i[a.serviceNum].serviceId,price:i[a.serviceNum].defaultPrice,sessionDuration:i[a.serviceNum].defaultSessionDuration,time:a.time,date:a.date,specialRequests:""};try{let e=await fetch("/app/api/booking",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}),t=await e.json();201==t.status&&alert("booking success")}catch(e){console.error("Error creating booking:",e)}};return(0,s.jsxs)("div",{className:"w-[90%] mx-auto",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Summary"}),(0,s.jsx)("table",{className:"w-full border border-gray-300 rounded-lg overflow-hidden",children:(0,s.jsxs)("tbody",{children:[a.date&&(0,s.jsxs)("tr",{className:"border-b",children:[(0,s.jsx)("td",{className:"p-2 font-semibold",children:"Date"}),(0,s.jsx)("td",{className:"p-2",children:a.date})]}),a.time&&(0,s.jsxs)("tr",{className:"border-b",children:[(0,s.jsx)("td",{className:"p-2 font-semibold",children:"Time"}),(0,s.jsx)("td",{className:"p-2",children:a.time})]}),a.firstName&&(0,s.jsxs)("tr",{className:"border-b",children:[(0,s.jsx)("td",{className:"p-2 font-semibold",children:"Member"}),(0,s.jsxs)("td",{className:"p-2",children:[a.firstName," ",a.lastName]})]}),i[0].defaultPrice&&(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{className:"p-2 font-semibold",children:"Price"}),(0,s.jsxs)("td",{className:"p-2",children:["R",i[a.serviceNum].defaultPrice]})]})]})}),(0,s.jsxs)("div",{className:"flex ",children:[(0,s.jsx)("button",{onClick:()=>t(r-1),className:"",children:"Prev"}),(0,s.jsx)("button",{onClick:d,children:"comfirm"})]})]})},u=function(e){var t,r;let{select:a,viewNum:i,viewselected:l,data:n,avaiableDate:d,bookingsetting:c,timetaken:o}=e,m=(null==(t=d[n.dayOfWeek])?void 0:t.startTime)||"09:00",u=(null==(r=d[n.dayOfWeek])?void 0:r.endTime)||"17:00",x=function(e,t,r){let s=[],[a,i]=e.split(":").map(Number),[l,n]=t.split(":").map(Number),d=new Date;d.setHours(a,i,0,0);let c=new Date;for(c.setHours(l,n,0,0);d<=c;){let e=d.getHours().toString().padStart(2,"0"),t=d.getMinutes().toString().padStart(2,"0");s.push("".concat(e,":").concat(t)),d.setMinutes(d.getMinutes()+r)}return s}(m,u,c[n.serviceNum].defaultSessionDuration||60),h=new Date(n.date).toISOString().split("T")[0],b=x.filter(e=>!o.some(t=>new Date(t.date).toISOString().split("T")[0]===h&&t.time===e));return(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{children:"Time"}),(0,s.jsxs)("div",{className:"grid grid-cols-3 gap-3",children:[0==b.length&&(0,s.jsx)("div",{children:"Day fully booked"}),b.map(e=>(0,s.jsx)("button",{onClick:()=>a({...n,time:e}),className:"px-4 py-2 rounded-lg border \n              ".concat(n.time===e?"bg-blue-500 text-white border-blue-600":"bg-gray-100 hover:bg-gray-200"),children:e},e))]}),(0,s.jsx)("br",{}),(0,s.jsx)("button",{onClick:()=>i(l-1),children:"prev"}),(0,s.jsx)("button",{onClick:()=>i(l+1),disabled:""===n.time,children:"next"})]})};var x=r(5181);let h=()=>{let[e,t]=(0,a.useState)({dayOfWeek:null,serviceNum:null,date:"",time:"",firstName:"",lastName:"",price:""}),[r,l]=(0,a.useState)([]),[o,h]=(0,a.useState)([]),[b,p]=(0,a.useState)(!0),[N,g]=(0,a.useState)(0),[j,v]=(0,a.useState)([]),f=async()=>{let e=await fetch("/app/api/operating-hours"),t=await e.json(),r=await fetch("/app/api/bookingdates");v((await r.json()).data),l(t)},y=async()=>{let e=await fetch("/app/api/booking-settings"),t=await fetch("/app/api/services"),r=await fetch("/app/api/team"),s=await e.json(),a=await t.json(),i=await r.json();h(s.map(e=>{let t=a.find(t=>t.id===e.serviceId)||null,r=(0,x.A)(e.providerIds.toString()),s=i.filter(e=>null==r?void 0:r.includes(e.id))||[];return{...e,service:t,provider:s}})),p(!1)};return((0,a.useEffect)(()=>{f(),y()},[]),b)?(0,s.jsx)("div",{children:"... Loading"}):(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("h1",{children:"Book Time"}),(()=>{switch(N){case 0:default:return(0,s.jsx)(c,{select:t,viewNum:g,data:e,bookingsetting:o,viewselected:N});case 1:return(0,s.jsx)(d,{select:t,data:e,viewNum:g,bookingsetting:o,viewselected:N});case 2:return(0,s.jsx)(i,{select:t,avaiableDate:r,data:e,viewNum:g,viewselected:N});case 3:return(0,s.jsx)(u,{select:t,avaiableDate:r,data:e,bookingsetting:o,viewNum:g,viewselected:N,timetaken:j});case 4:return(0,s.jsx)(m,{viewNum:g,data:e,bookingsetting:o,viewselected:N});case 5:return(0,s.jsx)(n,{viewNum:g,data:e,viewselected:N})}})()]})}},5181:(e,t,r)=>{"use strict";function s(e){if(!e)return[];try{let t=JSON.parse(e);if(Array.isArray(t))return t;if("string"==typeof t)return[t]}catch(e){}return e.includes(",")?e.split(",").map(e=>e.trim()).filter(Boolean):[e.trim()]}r.d(t,{A:()=>s})}},e=>{e.O(0,[471,441,255,358],()=>e(e.s=415)),_N_E=e.O()}]);