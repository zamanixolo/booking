(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[91],{2113:(e,s,l)=>{"use strict";l.d(s,{default:()=>o});var t=l(5155),a=l(2115);let i=function(e){let{id:s,select:l}=e,[i,r]=(0,a.useState)("Profile");return(0,a.useEffect)(()=>{switch(i){case"Profile":default:l(0);break;case"Current Booking":l(1);break;case"Booking History":l(2)}},[i]),(0,t.jsxs)("div",{className:"flex flex-col h-[100vh] w-fit p-2 bg-gray-400 text-left items-start",children:[(0,t.jsx)("h2",{className:"font-semibold",children:i}),(0,t.jsx)("p",{children:s}),(0,t.jsx)("button",{className:"text-left w-[100%] text-white p-2 hover:bg-gray-300",onClick:()=>r("Profile"),children:"Profile"}),(0,t.jsx)("button",{className:"text-left w-[100%] text-white p-2 hover:bg-gray-300",onClick:()=>r("Booking History"),children:"Bookings"})]})},r=function(e){let{id:s}=e,[l,i]=(0,a.useState)({email:"",firstName:"",lastName:"",phone:"",imageurl:""}),[r,n]=(0,a.useState)(!1),[o,d]=(0,a.useState)(!1),c=async()=>{try{d(!0);let e=await fetch("/api/User",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({clerkId:s,userData:l})});if(e.ok){let s=await e.json();i({email:s.email||"",firstName:s.firstName||"",lastName:s.lastName||"",phone:s.phone||"",imageurl:s.imageurl||""})}}catch(e){console.error("Error fetching profile:",e)}finally{d(!1)}},m=async e=>{e.preventDefault();try{d(!0);let e=await fetch("/api/User",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({clerkId:s,...l})});if(e.ok){let s=await e.json();console.log("Profile updated:",s),n(!1)}else console.error("Failed to update profile")}catch(e){console.error("Error updating profile:",e)}finally{d(!1)}},x=e=>{let{name:s,value:l}=e.target;i(e=>({...e,[s]:l}))};return((0,a.useEffect)(()=>{c()},[s]),o&&!l.email)?(0,t.jsx)("div",{className:"p-4",children:"Loading profile..."}):(0,t.jsxs)("div",{className:"max-w-2xl  p-6",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"Profile"}),(0,t.jsx)("div",{className:"bg-white shadow rounded-lg p-6",children:r?(0,t.jsxs)("form",{onSubmit:m,className:"space-y-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"firstName",className:"block text-sm font-medium text-gray-700",children:"First Name"}),(0,t.jsx)("input",{type:"text",id:"firstName",name:"firstName",value:l.firstName,onChange:x,className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-blue-500 focus:border-blue-500",required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"lastName",className:"block text-sm font-medium text-gray-700",children:"Last Name"}),(0,t.jsx)("input",{type:"text",id:"lastName",name:"lastName",value:l.lastName,onChange:x,className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-blue-500 focus:border-blue-500",required:!0})]}),(0,t.jsxs)("div",{className:"col-span-2",children:[(0,t.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email"}),(0,t.jsx)("input",{type:"email",id:"email",name:"email",value:l.email,onChange:x,className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-blue-500 focus:border-blue-500",required:!0})]}),(0,t.jsxs)("div",{className:"col-span-2",children:[(0,t.jsx)("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700",children:"Phone"}),(0,t.jsx)("input",{type:"tel",id:"phone",name:"phone",value:l.phone,onChange:x,className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),(0,t.jsxs)("div",{className:"col-span-2",children:[(0,t.jsx)("label",{htmlFor:"imageurl",className:"block text-sm font-medium text-gray-700",children:"Profile Image URL"}),(0,t.jsx)("input",{type:"url",id:"imageurl",name:"imageurl",value:l.imageurl,onChange:x,className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]})]}),(0,t.jsxs)("div",{className:"flex space-x-3 pt-4",children:[(0,t.jsx)("button",{type:"submit",disabled:o,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50",children:o?"Saving...":"Save Changes"}),(0,t.jsx)("button",{type:"button",onClick:()=>{n(!1),c()},className:"px-4 py-2 bg-gray-300 text-gray-700 rounded hover:bg-gray-400",children:"Cancel"})]})]}):(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-4 mb-6",children:[l.imageurl&&(0,t.jsx)("img",{src:l.imageurl,alt:"Profile",className:"w-20 h-20 rounded-full object-cover"}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("h2",{className:"text-xl font-semibold",children:[l.firstName," ",l.lastName]}),(0,t.jsx)("p",{className:"text-gray-600",children:l.email})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"First Name"}),(0,t.jsx)("p",{className:"mt-1 text-sm text-gray-900",children:l.firstName})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Last Name"}),(0,t.jsx)("p",{className:"mt-1 text-sm text-gray-900",children:l.lastName})]}),(0,t.jsxs)("div",{className:"col-span-2",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),(0,t.jsx)("p",{className:"mt-1 text-sm text-gray-900",children:l.email})]}),(0,t.jsxs)("div",{className:"col-span-2",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Phone"}),(0,t.jsx)("p",{className:"mt-1 text-sm text-gray-900",children:l.phone||"Not provided"})]})]}),(0,t.jsx)("button",{onClick:()=>n(!0),className:"mt-6 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Edit Profile"})]})})]})},n=function(e){let{userId:s}=e,[l,i]=(0,a.useState)([]),[r,n]=(0,a.useState)(!1),[o,d]=(0,a.useState)(!1),[c,m]=(0,a.useState)(null),[x,h]=(0,a.useState)([]),[u,g]=(0,a.useState)({date:null,id:null,providerId:null,time:null});(0,a.useEffect)(()=>{(async()=>{if(s){n(!0);try{let e=await fetch("/api/booking?clientId=".concat(s)),l=await e.json();i(l),console.log(l)}catch(e){console.error("Error fetching bookings:",e)}finally{n(!1)}}})()},[s]),(0,a.useEffect)(()=>{(async()=>{let e=await fetch("/api/team/getActiveProvider");h(await e.json())})()},[]);let p=async e=>{console.log(e);let s=await fetch("/api/booking/".concat(e),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e,updateData:u})});await s.json()},b=e=>{let{name:s,value:l}=e.target;g(e=>({...e,[s]:""===l?null:l}))};return s?r?(0,t.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Bookings"}),(0,t.jsx)("p",{children:"Loading your bookings..."})]}):(0,t.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Bookings"}),0===l.length?(0,t.jsx)("p",{children:"No bookings found."}):(0,t.jsx)("div",{className:"space-y-4",children:null==l?void 0:l.map(e=>(0,t.jsx)("div",{className:"border-b pb-4 last:border-b-0 cursor-pointer hover:bg-gray-50 p-2 rounded",onClick:()=>{m(e.id),g({...u,date:e.date.split("T")[0],id:e.id,time:e.time,providerId:e.providerId}),d(!0),console.log(e),console.log(u)},children:(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-medium",children:e.services.name}),(0,t.jsxs)("p",{className:"text-sm text-gray-600",children:[new Date(e.date).toLocaleDateString()," at ",e.time]}),(0,t.jsxs)("p",{className:"text-sm text-gray-600",children:["with ",e.provider.firstName," ",e.provider.lastName]})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsxs)("p",{className:"font-medium",children:["R",e.price]}),(0,t.jsx)("p",{className:"text-sm text-gray-600",children:e.status})]})]})},e.id))}),o&&c&&(0,t.jsx)(e=>{let{id:s,onClose:l}=e;return(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,t.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-xl max-w-md w-full mx-4",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold",children:"Edit Booking"}),(0,t.jsx)("button",{onClick:l,className:"text-gray-500 hover:text-gray-700 text-2xl",children:"\xd7"})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("p",{children:["Editing Booking ID: ",(0,t.jsx)("strong",{children:s})]}),(0,t.jsxs)("p",{className:"text-sm text-gray-600",children:[(0,t.jsxs)("fieldset",{children:[(0,t.jsx)("legend",{children:"Provider "}),(0,t.jsx)("select",{children:x.map(e=>(0,t.jsxs)("option",{children:[e.firstName," ",e.lastName]},e.id))})]}),(0,t.jsxs)("fieldset",{children:[(0,t.jsx)("legend",{children:"Booking Details"}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{children:"Date:"}),(0,t.jsx)("input",{type:"date",name:"date",value:u.date||"",onChange:b})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{children:"Time:"}),(0,t.jsx)("input",{type:"time",name:"time",value:u.time||"",onChange:b})]})]})]}),(0,t.jsxs)("div",{className:"flex justify-end space-x-2 mt-6",children:[(0,t.jsx)("button",{onClick:l,className:"px-4 py-2 bg-gray-300 text-gray-700 rounded hover:bg-gray-400",children:"Cancel"}),(0,t.jsx)("button",{onClick:()=>{p(s)},className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Save Changes"})]})]})]})})},{id:c,onClose:()=>{d(!1),m(null)}})]}):(0,t.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Bookings"}),(0,t.jsx)("p",{children:"Please sign in to view your booking history."})]})},o=function(e){let{id:s}=e,[l,o]=(0,a.useState)(0);return(0,t.jsxs)("div",{className:"flex w-[100vw]",children:[(0,t.jsx)(i,{id:s,select:o}),0==l&&(0,t.jsx)(r,{id:s}),2==l&&(0,t.jsx)(n,{userId:s})]})}},6428:(e,s,l)=>{Promise.resolve().then(l.bind(l,2113))}},e=>{e.O(0,[441,255,358],()=>e(e.s=6428)),_N_E=e.O()}]);